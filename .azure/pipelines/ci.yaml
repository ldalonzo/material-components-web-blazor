name: $(Major).$(Minor).$(rev:r)

resources:
- repo: self
  clean: true

pool:
  name: Hosted Windows 2019 with VS2019
  demands:
  - npm

variables:
  Major: 0
  Minor: 0
  BuildConfiguration: 'Release'

steps:
- checkout: self
  clean: true

- task: Npm@1
  displayName: 'npm install'
  inputs:
    workingDir: src\Blazor.Material
    verbose: false

- task: Npm@1
  displayName: 'npm run build'
  inputs:
    command: custom
    workingDir: src\Blazor.Material
    verbose: false
    customCommand: 'run build'

- task: DotNetCoreInstaller@0
  displayName: 'Use .NET Core SDK 3.0.100-preview6-012264'
  inputs:
    version: '3.0.100-preview6-012264'

- task: DotNetCoreCLI@2
  displayName: 'dotnet publish'
  inputs:
    command: publish
    publishWebProjects: false
    projects: |
     **/Blazor.Material.csproj
    arguments: '--configuration $(BuildConfiguration) --output $(Build.ArtifactStagingDirectory) -p:Version=$(Build.BuildNumber)'

- task: PublishBuildArtifacts@1
  displayName: 'Publish Artifact: drop'
